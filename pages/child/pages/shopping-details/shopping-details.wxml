<wxs module="filters" src="../../../../utils/number.wxs"></wxs>
<import src="../../../../utils/wxParse/wxParse.wxml" />
<scroll-view class="body" scroll-y="true">
<!-- 商品轮播图 -->
<swiper class="lunbo" autoplay="true" circular="true">
  <swiper-item wx:for="{{data.imgList}}" wx:key="index">
    <image src="{{item}}" class="lunbo-img" mode="aspectFill" bindtap="imgClick" data-list="{{data.imgList}}" data-src="{{item}}"></image>
  </swiper-item>
</swiper>
<view class="xinxi">
  <!-- <view class="xinxi-er">
    <text>销量{{data.salesNum}}</text>
    <text>快递: {{data.freeShippingTypeText}}</text>
  </view> -->
  <view class="xinxi-san">
    <view class="xinxi-san-er">¥{{data.price}}
      <!-- <text wx:if="{{data.multi}}">起</text> -->
    </view>
    <view class="xinxi-san-san" wx:if="{{vipRate&&vipGrade>1}}">会员价</view>
    <view class="xinxi-san-yi" wx:if="{{vipRate&&vipGrade>1}}">￥{{vipGrade==1?data.price:filters.toFix(data.price - data.profit * vipRate)}}</view>
  </view>
  <!-- 会员展示 -->
  <view class="xinxi-hy" bindtap="govipdetails"> 
    <view class="xinxi-hy-yi">VIP</view>
    <view class="xinxi-hy-er" wx:if="{{vipGrade!=data.highestLevel}}">升级会员,此商品可赚 ¥{{data.vipFavorable}}元</view>
    <view class="xinxi-hy-er" wx:else>尊敬的黑金会员，您已是最高等级</view>
    <view class="xinxi-hy-san">{{vipGrade!=data.highestLevel?'立即加入':'立即分享'}}</view>
  </view>
  <view class="xinxi-yi">{{data.goodsName}}</view>
</view>
<!-- 包邮和销量 -->
<view class="baoyou">
  <view class="baoyou-yi">快递:{{data.freeShippingTypeText}}</view>
  <view class="baoyou-er">月销量{{data.salesNum}}+</view>
</view>
<!-- 选择规格 -->
<view class="xzgg" wx:if="{{data.multi}}"  bindtap="kaiq">
  <view class="xinxi-si">
    <view class="xinxi-si-left">选择: {{guigedetailss.specName}}</view>
    <image src="../images/index_arrows.png" class="xinxi-si-right"></image>
  </view>
  <view class="xzgg-yi">
    <text wx:key="guige">{{guigedetailss.specAttrList[0].specValue}}</text>
    <text wx:key="guige">共有{{guigedetailss.specAttrList.length}}种{{guigedetailss.specName}}</text>
  </view>
</view>
<!-- 售后期限及发货时间说明 -->
<view class="shouh">
  <view>
    <text class="shouh1">承诺:</text>
    <text class="shouh1 shouh3">{{data.deliveryTime}}</text>
    <text class="shouh2">•售后期限{{data.afterSaleTime}}</text>
  </view>
  <!-- <view>
    <text class="shouh1">售后期限</text>
    <text class="shouh2">{{data.afterSaleTime}}</text>
  </view> -->
</view>
<!-- 评价 -->
<view class='shops-head'>
    <view class='head-box'>
      <view class='eva-head'>
        <view class='evaluate'>
          <text class='eva-pro'>产品评价</text>
          <text class='eva-num'>(好评率{{data.favorableComment || 100}}%)</text>
        </view>
        <view class='eva-all' bindtap="checkEva">
          {{data.commentList.length}}条评论
          <image src='../images/index_arrows.png'></image>
        </view>
      </view>
      <block wx:for="{{data.commentList}}" wx:key="index" wx:if="{{data.commentList.data.length !=0 }}">
        <view class='use-list'>
          <view class='user-img'>
            <image wx:if="{{item.userHead==null}}" src="/pages/images/default_head_portrait.png"></image>
            <image wx:else src='{{item.userHead}}'></image>
          </view>
          <view class='user-box'>
            <view class='user-name'>{{item.nickName}}</view>
            <view class='user-title'>{{item.content}}</view>
          </view>
          <view class='user-time'>{{item.createDate}}</view>
        </view>
      </block>
      <view wx:if="{{data.commentList.length ==0}}" class="noeva">该商品还没有评价!</view>
    </view>
  </view>
<!-- 店铺 -->
 <view class='shops-head' bindtap='handleShop'>
    <view class='head-box'>
      <view class='shop-img'>
        <image mode="aspectFill" src='{{data.shopBaseDTO.imgPath}}'></image>
      </view>
      <view class='shop-content'>
        <view class='shop-content-title'>{{data.shopBaseDTO.shopName}}</view>
        <view class='shop-content-star'>
          <block wx:for="{{data.shopBaseDTO.score}}" wx:key="item">
            <image src='../images/star3.png'></image>
          </block>
          <block wx:for="{{5-data.shopBaseDTO.score}}" wx:key="item">
            <image src='../images/star2.png'></image>
          </block>
        </view>
        <view class='shop-content-intro'>{{data.shopBaseDTO.desc}}</view>
        <view class='shop-content-img'>
          <image src='../images/management_site.png'></image>
        </view>
      </view>
    </view>
  </view>
<!-- 猜你喜欢 -->
<view class="xihuan" wx:if="{{data.youLikeList.length>0}}">
  <view class="xihuan-top">猜你喜欢</view>
  <scroll-view scroll-x="true" class="xihuan-bottom">
    <view class="xh" wx:for="{{data.youLikeList}}" wx:key="index" data-goodsNo="{{item.goodsNo}}" bindtap="goyoulike">
      <image src="{{item.imgPath}}" mode="aspectFill"></image>
      <view class="xh-name">{{item.goodsName}}</view>
      <view class="xh-jiage">￥{{item.price}}</view>
    </view>
  </scroll-view>
</view>
<!-- 商品详情 -->
  <view class='shopDetails'>
    <view class='shopDetails-title'> 商品详情</view>
    <view class="imglist-h5">
      <template is="wxParse" data="{{wxParseData:detailh5.nodes}}" />
      <!-- <image  wx:for="{{detailh5}}" data-src="{{item.imgPath}}"  mode="widthFix" src="{{item.imgPath}}"  catchtap="imgDetails" ></image> -->
        <!-- 到底提示 -->
      <view class="bottom-title">
        <view> 已经全部加载完了~ </view>
      </view>
    </view>
  </view>
  </scroll-view>
  <!-- 按钮 -->
  <view class='pay activity-pay'>
    <view class='pay-left'>
    <view class='navto' bindtap='handleShop'>
      <image src='../images/store_entrance.png'></image>
      店铺
    </view>
    <view class='navto' bindtap='tocart'>
      <image src='../images/shopping_entrance.png'></image>
      购物车
      <view class="{{cartNum != 0 ? 'cartNum' :''}}">{{cartNum != 0 ? cartNum :''}}</view>
    </view>
    <view class='navto' bindtap='shoucang'>
      <image src="{{isCollect?'../images/shoucang1.png':'../images/shoucang2.png'}}"></image>
      收藏
    </view>
  </view>
        <button class='activity-title2' bindtap="gogoumai">立即购买</button>
  <view class="activity-title" bindtap='handlePay'>
      <view>加入购物车</view>
  </view>
</view>
<!-- 规格弹框 -->
<view class="mask-layer" wx:if="{{guigec}}" bindtap="yingc"></view>
<scroll-view class="guige" wx:if="{{guigec}}" animation='{{animationData}}' scroll-y="true">
  <view class="guige-yi">
    <image src="{{guigedetails.specImg}}" class="guige-yi-left"></image>
    <view class="guige-yi-center">
      <image src="../images/cha.png" bindtap="yingc"></image>
      <view class="guige-yi-jiage">￥{{guigedetails.price}}</view>
      <view class="guige-yi-huiyuan">
        <view wx:if="{{vipRate&&vipGrade>1}}">会员价</view>
        <view wx:if="{{vipRate&&vipGrade>1}}">￥{{vipGrade==1?guigedetails.price:filters.toFix(guigedetails.price - guigedetails.profit * vipRate)}}</view>
      </view>
      <view class="guige-yi-xuanz">已选规格：{{guigedetails.specValue}}</view>
      <view class="guige-yi-kucun" wx:hidden="{{guigedetails.num}}">库存:{{guigedetails.num}}</view>
    </view>
  </view>
  <view class="guige-er">
    <view class="guige-er-yi">请选择规格</view>
    <view class="guige-xuanze">
      <view wx:for="{{guigelist}}" wx:key='index'>
        <view class="guige-biaoti">{{item.specName}}</view>
        <text class="{{items.ps?'xuanze1':'xuanze2'}}" wx:for='{{item.specAttrList}}' wx:for-item="items" wx:key="index2" bindtap="guigex" data-specname="{{item.specName}}" data-stocknos="{{items.stockNo}}">{{items.specValue}}</text>
      </view>
    </view>
  </view>
  <view class="selectCount">
    <view class="countname">数量</view>
    <view class="countright">
      <text class="{{minusStatus}}" bindtap="bindMinus">-</text>
      <input type='number' bindchange="bindManual" value='{{num}}' disabled></input>
      <text class="normal" bindtap="bindPlus">+</text>
    </view>
  </view>
  <view class="guige-san">
    <text class="guige-san-yi" bindtap="goxiadanyi">加入购物车</text>
    <text class="guige-san-er" bindtap="goxiadaner">立即购买</text>
  </view>
</scroll-view>
<!-- 登录弹窗 -->
<logins id="logins" bind:callSomeFun="callSomeFun"></logins>